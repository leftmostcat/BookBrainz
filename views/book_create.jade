// vim: set ts=4 sw=4 :

extends layout

block head
	link(rel='stylesheet', href='/css/select2-3.4.8.css')

block content
	form(action='/book/add', method='post')
		dl
			dt Title:
			dd
				input(type='text', name='title')

			dt Creator:
			dd
				input#creator(type='hidden', name='creator_id', style='width: 200px;')

			dt Creator Credit:
			dd
				input(type='text', name='creator_name')

			dt Primary Type:
			dd
				select(name='book_primary_type_id')
					option(value='1') Book

			dt Comment:
			dd
				textarea(name='comment')

			input(type='submit', value='Add Book')

block js
	script(type='text/javascript' src='/js/jquery-1.11.1.js')
	script(type='text/javascript' src='/js/select2-3.4.8.js')

	script(type='text/javascript').
		$(document).ready(function() {
			$('#creator').select2({
				placeholder: 'Select Creatorâ€¦',
				minimumInputLength: 1,
				ajax: {
					url: '/search/autocomplete',
					dataType: 'json',
					data: function(query, page) {
						return {
							query: query,
							type: 'creator'
						};
					},
					results: function(data, page) {
						return { results: data };
					}
				},
				formatResult: function(result) {
					var formatted = result.text;

					if (result.comment)
						formatted += ' (' + result.comment + ')';

					return formatted;
				}
			});
		});
